---
title: Lezione (2025-11-13)
---

## Quantizzazione

Il segnale ottenuto tramite il campionatore ha ancora valori continui in
ampiezza, quindi non si può rappresentare in forma numerica. La quantizzazione è
il passaggio che si occupa di discretizzare i campioni in ampiezza, associandoli
ad un numero limitato di livelli.

Dato il segnale campionato $x(n T_c)$ avremo:

$$
x(n T_c) = x_q(n T_c) + \varepsilon_q(n T_c)
$$

:::caution

L'errore (o rumore di quantizzazione) $\varepsilon_q$ è inevitabile: il
campionamento è sempre un'operazione lossy.

:::

Il numero di livelli viene solitamente scelto come una potenza di $2$, in modo
che $2^N$ livelli siano rappresentabili con $N$ bit. Il livello che viene
assegnato è quello a distanza minore dal valore reale del segnale.

### Quantizzatore uniforme

Nel quantizzatore uniforme, gli $M$ livelli sono equispaziati, quindi il massimo
errore $\varepsilon_q$ che posso commettere su un campione è
$|\frac{\Delta}{2}|$ (se il segnale in ingresso varia tra $\pm 1$
($\Delta = \frac{2}{M}$), allora l'errore massimo è $\frac{1}{M}$.).

La relazione ingresso-uscita è una funzione a scalini non lineare.

### Rumore di quantizzazione

Se la distribuzione dei valori assunti dal segnale è uniforme (la densità di
probabilità è un rettangolo), allora anche errore di quantizzazione sarà una
variabile aleatoria $f_{\varepsilon_q}(\varepsilon)$ distribuita uniformemente
in $[- \frac{\Delta}{2}, \frac{\Delta}{2}]$ e di altezza $\frac{1}{\Delta}$.

Si può stimare la potenza media del rumore che coincide con la varianza e con il
valore quadratico medio:

$$
\sigma_q^2 = \int_{-\frac{\Delta}{2}}^{\frac{\Delta}{2}} \varepsilon^2\ f_{\varepsilon_q}(\varepsilon)\ d\varepsilon
           = \frac{1}{\Delta} \int_{-\frac{\Delta}{2}}^{\frac{\Delta}{2}} \varepsilon^2\ d\varepsilon
           = \frac{\Delta^2}{12}
$$

### Rapporto segnale-rumore

Più che la potenza del rumore, è interessante misurare il suo rapporto con la
potenza del segnale $x(t)$.

Questo rapporto viene chiamato **rapporto segnale-rumore**:

$$
SNR = 10\ \log_{10}\left(\frac{P_x}{P_{\varepsilon_q}}\right)
$$

Più elevato è il rapporto, maggiore sarà la qualità di un segnale. Per un
segnale a valor medio nullo, si può dimostrare che ogni bit aggiunto (raddoppio
dei livelli) fa aumentare il valore del rapporto di 6 dB.

### Quantizzatore ottimo

Quando il segnale è distribuito in maniera non uniforme, il quantizzatore
dovrebbe generare più livelli nella zona dove il segnale ha maggiore probabilità
di essere presente. Per realizzarlo bisogna ottimizzare congiuntamente la
posizione dei punti di transizione e quella dei livelli rappresentativi in modo
da minimizzare l'errore quadratico medio del quantizzatore.

L'algoritmo di Lloyd-Max è quello che ci permette di eseguire questa
ottimizzazione. Per applicarlo bisogna definire a priori la distribuzione del
segnale e il numero di livelli che si vuole supportare.

1. Si scelgono arbitrariamente i valori dei livelli $a_i,\ i = 1, \ldots, n$.
2. Si impostano i punti di soglia $b_j,\ j = 1, \ldots, n - 1$ ai valori
   centrali tra livelli successivi: $b_j = \frac{1}{2} (a_{j + 1} + a_j)$.
3. Si ricalcolano i livelli di quantizzazione $a_i, i=1,\ldots,n$ imponendoli
   pari alla media della differenza di potenziale in $[b_{i - 1}, b]$, con
   $b_0 = -\infty$ e $b_n = +\infty$.
4. Si calcola l'errore quadratico medio confrontandolo con il ciclo precedente.
   Se la variazione è inferiore ad una certa soglia, allora ci si può fermare.
   Altrimenti si ripete il ciclo dal punto 2.

:::note

L'algoritmo converge sempre, però non è garantito che esso non si fermi in un
minimo locale.

:::

## Codificatore PCM

Una volta quantizzato il segnale abbiamo ottenuto campioni discreti con un
numero finito di livelli di ampiezza. Quindi si può rappresentare il segnale in
forma simbolica, associando ad ogni campione un codice (tipicamente binario).

Il codificatore deve quindi associare una sequenza biunivoca di $B$ bit ad ogni
campione, che codificherà il suo livello tra $2^B$ possibili.

L'intero processo di campionatura, quantizzazione e codifica prende il nome di
PCM.

In uscita dalla PCM, avremo una sequenza di bit, emessi con una certa frequenza.
Per un segnale con $N$ campioni al secondo e $M$ livelli, il bitrate sarà:

$$
r_b = N\ \fLogn{2}{M} = N\ B
$$

Quindi la bitrate è legata alla massima frequenza (larghezza di banda) del
segnale e alla qualità che vogliamo ottenere dopo la quantizzazione.
