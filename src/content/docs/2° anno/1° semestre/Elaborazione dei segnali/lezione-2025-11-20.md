---
title: Lezione (2025-11-20)
---

## Definire un kernel di convoluzione per ottenere un dato obiettivo

Vogliamo, come nel caso analogico, definire delle strategie per scegliere un
kernel che abbia il comportamento che desideriamo (ad esempio filtro
passa-basso, etc...).

In teoria bisognerebbe campionare la risposta impulsiva analogica $h(t)$ per
ottenere $h[k]$. Però con una risposta impulsiva con frequenze limitate si
ottengono infiniti campioni nel tempo.

Questo tipo di filtro viene chiamato **Infinite Impulse Response** (IIR) ed è
irrealizzabile dato che ciascun campione richiederebbe una quantità infinita di
somme e prodotti.

Per renderlo realizzabile bisogna tagliare il kernel ad una lunghezza limitata
nel tempo. Si ottiene così un filtro **Finite Impulse Response** (FIR). Con
questa operazione si introducono sia un errore (cambia la risposta in
frequenza), sia un effetto di aliasing.

Vediamo ora alcuni comuni esempi di filtri FIR:

### LPF a media mobile

Il kernel del filtro a media mobile contiene coefficienti con lo stesso valore:

$$
h[k] = \left[\frac{1}{K}\ \frac{1}{K}\ \dots\ \frac{1}{K}\right] = \frac{1}{K} [1\ 1\ \dots\ 1]
$$

Quando viene usato nella convoluzione, esso sostituisce ogni campione con la
media dei $K$ campioni che cadono dentro la finestra centrata in esso.

La normalizzazione $\frac{1}{K}$ serve per evitare di alterare il valor medio
del segnale in ingresso.

L'intensità del filtro dipende solo dal valore di $K$. Più è lungo il kernel,
minore sarà l'ampiezza in frequenza del filtro.

### LPF Gaussiano

Anche per $K$ piccoli, il filtro a media mobile produce un effetto pesante sul
segnale in entrata.

Prendendo una media pesata, dando maggior importanza ai pesi vicini al centro,
si ottiene un effetto più moderato. Normalmente, per ottenere questo
comportamento, si utilizza una distribuzione gaussiana.

La gaussiana avrà valor medio nullo e varianza $\sigma^2$. Maggiore è il valore
di $\sigma$, maggiore sarà l'estensione della curva, producendo una media più
estesa e uniforme (con $\sigma \to \infty$ si ottiene il filtro a media mobile).

### HPF

Come abbiamo visto in precedenza, i filtri passa-alto possono essere ottenuti
per differenza dal corrispondente passa basso:

$$
h_\text{HPF}[k] = \delta[k] - h_\text{LPF}[k] = [0\ 0\ 1\ 0\ 0] - [\frac{1}{5}\ \frac{1}{5}\ \frac{1}{5}\ \frac{1}{5}\ \frac{1}{5}] = [-\frac{1}{5}\ -\frac{1}{5}\ \frac{4}{5}\ -\frac{1}{5}\ -\frac{1}{5}]
$$

:::note

Nei filtri passa basso, la somma dei coefficienti deve essere 1 (non modifica il
valor medio del segnale), nel passa alto deve essere 0 (annulla il valor medio
del segnale).

:::

Due esempi di filtri passa alto sono:

- filtro a gradino: $h[k] = [-1\ 1]$, esegue una derivata prima discreta del
  segnale.
- filtro laplaciano: $h[k] = [0\ 1\ -2\ 1\ 0]$, esegue una derivata seconda del
  segnale.

  ### Filtri iterativi

  Preso un LPF ideale, esso taglierà le frequenze maggiori di $f_0$.
  Applicandolo nuovamente non cambia il risultato.

  I filtri FIR invece, vengono applicati in maniera approssimata (perchè sono
  stati finestrati). Quindi l'applicazione ripetuta del filtro produrrà un nuovo
  taglio ad ogni iterazione.

  Per intensificare l'effetto di un filtro si può quindi pensare di iterarlo.
