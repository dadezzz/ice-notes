---
title: Lezione (2025-11-21)
---

Preso un circuito RLC dove $V_\text{in}(t)$ è un ingresso causale ci interessa
la differenza di potenziale ai capi di $R$:

```text
┌───L───C───┐
│+          │
V_in        R
│-          │
└───────────┘
```

Possiamo dire che esistono
$\tilde{V}_\text{in}(s) = \trLaplaceB{V_\text{in}(t)}$ e
$\tilde{I}(s) = \trLaplaceB{I(t)}$.

Scriviamo il sistema non sapendo ancora le condizioni iniziali:

$$
\begin{dcases}
V_\text{in}(t) = V_L(t) + V_C(t) + V_R(t) \\
I(t) = I_L(t) = I_C(t) = I_R(t) \\
V_L(t) = L \dv{I_L}{t}(t) \\
V_R(t) = I_R(t)\ R \\
V_C(t) = \frac{1}{C} \int_0^t I_C(t) dt + V_C(0) \\
I_L(0) = ? \\
V_C(0) = ?
\end{dcases}
$$

$$
\begin{dcases}
V_\text{in}(t) = L \frac{I}{t}(t)
               + I(t)\ R
               + \frac{1}{C} \int_0^t I(t') dt' + V_C(0) \\
I_L(0) = ? \\
V_C(0) = ?
\end{dcases}
$$

$$
\begin{dcases}
\tilde{V}_\text{in}(s) = L\ s\ \tilde{I}(s) - L\ I(0) + \tilde{I}(t)\ s\ R + \frac{1}{C\ s} \tilde{I}(s) + \frac{V_C(0)}{s} \\
  \iff \tilde{V}_\text{in}(s) = \tilde{I}(s) \left(L\ s + R + \frac{1}{C\ s}\right) - L\ I(0) + \frac{V_C(0)}{s}
  \iff s\ \tilde{V}_\text{in}(s) = \tilde{I}(s) \left(L\ s^2 + R\ s+ \frac{1}{C}\right) - L\ s\ I(0) + V_C(0)
  \iff \tilde{I}(s) = \frac{s\ \tilde{V}_\text{in}(s) + L\ s\ I(0) - V_C(0)}{L\ s^2 + R\ s + \frac{1}{C}}
  \iff \tilde{V_R}(s) = \frac{R\ s\ \tilde{V}_\text{in}(s) + R\ L\ s\ I(0) - R\ V_C(0)}{L\ s^2 + R\ s + \frac{1}{C}}
  \iff \tilde{V_R}(s) = \frac{R\ s\ \tilde{V}_\text{in}(s)}{L\ s^2 + R\ s + \frac{1}{C}} + \frac{R\ L\ s\ I(0) - R\ V_C(0)}{L\ s^2 + R\ s + \frac{1}{C}}
I_L(0) = ? \\
V_C(0) = ?
\end{dcases}
$$

Nell'ultima espressione ottenuta, il primo termine della somma (quello che
contiene $\tilde{V}_\text{in}(s)$) è la risposta a stato 0 del sistema. Il
secondo termine invece è la risposta a ingresso 0.

Ora stabiliamo alcuni dati:

- $V_\text{in}(t) = 2 \fSin{2 t} \fStep{t}\ [V]$
- $I(0) = 0\ [A]$
- $V_C(0) = 2\ [V]$
- $L = \frac{1}{2}\ [H]$
- $C = \frac{1}{3}\ [F]$
- $R = \frac{5}{2}\ [\omega]$

La trasformata del seno è:

$$
\fSin{d t} \trLaplaceA \frac{d}{s^2 + d^2}
$$

Quindi nel nostro caso avremo $\frac{4}{s^2 + 4}$. Ora sostituiamo le variabili
con le costanti date:

$$
\tilde{V_R}(s) = \frac{4}{s^2 + 4} \frac{s\ \frac{5}{2}}{\frac{s^2}{2} + \frac{5 s}{2} + 3} - \frac{5}{\frac{s^2}{2} + \frac{5 s}{2} + 3}
               = \frac{4}{s^2 + 4} \frac{5 s}{s^2 + 5 s + 6} - \frac{10}{s^2 + 5 s + 6}
               = \frac{4}{s^2 + 4} \frac{5 s}{(s + 2) (s + 3)} - \frac{10}{(s + 2) (s + 3)}
               = \frac{4}{(s + 2 j) (s - 2 j)} \frac{5 s}{(s + 2) (s + 3)} - \frac{10}{(s + 2) (s + 3)}
$$

Il problema sta nella risposta a stato 0, che contiene degli zeri complessi:

$$
\frac{20 s}{(s + 2 j) (s - 2 j) (s + 2) (s + 3)}
$$

La regola che dovremo usare è:

$$
2 |A|\ e^{-a t} \fCos{b t + \phi_A} \trLaplaceA \frac{A}{s + a - j b} + \frac{\overline{A}}{s + a + j b}
$$

:::tip

Una versione leggermente diversa (utile quando $K \in \R$) è:

$$
K\ e^{-p t}\ \fSin{\omega t} \trLaplaceA \frac{K \omega}{(s + p)^2 + \omega^2}
$$

dove

$$
(s + p)^2 + \omega^2 = (s + p + j \omega)(s + p - j \omega)
$$

:::

Quindi possiamo riscrivere l'espressione sopra come:

$$
\frac{A}{s + 2 j} + \frac{\overline{A}}{s - 2 j} + \frac{B}{s + 2} + \frac{C}{s + 3}
$$

Per trovare $A$ dobbiamo fare il limite:

$$
\lim_{s \to 2 j} (s - 2 j) \frac{20 s}{(s + 2 j) (s - 2 j) (s + 2) (s + 3)} = \frac{40 j}{4 j (2 j + 2) (2 j + 3)} = \frac{10}{2 + 10 j}
                                                                            = \frac{5}{1 + 5j}
                                                                            = \frac{5 - 25 j}{26}
$$

Otteniamo quindi:

$$
2 \frac{5}{\sqrt{26}} \fCos{2 t + \phi_A}
$$

La fase è data da $\fArctan{\frac{\Im{A}}{\Re{A}}}$.

$$
2 \frac{5}{\sqrt{26}} \fCos{2 t + 1.37}
$$

Per trovare $B$ e $C$ faccio i rispettivi limiti come visto l'altra volta e
ottengo i valori $-5$ e $\frac{60}{13}$

L'anti-trasformata della risposta a stato 0 è:

$$
V_{R}^\text{stato 0}(t) = \frac{10}{\sqrt{26}} \fCos{2 t - 1.37} - 5 e^{-2 t} + \frac{60}{13} e^{-3 t}
$$

La risposta a ingresso 0 si calcola con il metodo visto l'altra volta:

$$
V_R^\text{ingresso 0}(t) = 10 e^{-3 t} - 10 e^{-2 t}
$$

## Risposta all'impulso con laplace

La funzione di trasferimento $H(s)$ di un circuito corrisponde alla trasformata
della risposta all'impulso. Quindi anti-trasformando si ottiene $h(t)$.
